{"version":3,"sources":["page-sections.js"],"names":["makeTemplate","strings","html","substs","i","length","template","document","createElement","innerHTML","PageSections","_active","shadowRoot","attachShadow","mode","ShadyCSS","applyStyle","appendChild","importNode","content","_scrollEvent","bind","window","addEventListener","e","clearTimeout","fn","setTimeout","setActive","state","setAttribute","removeAttribute","_setActiveState","_inView","elements","querySelectorAll","active","getBoundingClientRect","bottom","prepareTemplate","customElements","define"],"mappings":"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","file":"page-sections.js","sourcesContent":["/* global HTMLElement */\n// import { makeTemplate } from './make-template.js'\n(function () {\n  const makeTemplate = function (strings, ...substs) {\n    var html = ''\n    for (let i = 0; i < substs.length; i++) {\n      html += strings[i]\n      html += substs[i]\n    }\n    html += strings[strings.length - 1]\n    var template = document.createElement('template')\n    template.innerHTML = html\n    return template\n  }\n\n  class PageSections extends HTMLElement {\n\n    constructor () {\n            // needs to be called first\n      super()\n            // set sections initial active state to false\n      this._active = false\n            // create shadowRoot\n      const shadowRoot = this.attachShadow({mode: 'open'})\n            // add content to shadowRoot & apply css polyfill\n      ShadyCSS.applyStyle(this) // eslint-disable-line no-undef\n      shadowRoot.appendChild(document.importNode(template.content, true))\n    }\n        /**\n         * get active state of parent container\n         * @method active\n         * @return {Boolean}\n         */\n    get active () {\n      return this._active\n    }\n\n    connectedCallback () {\n      this._scrollEvent = this._scrollEvent.bind(this)\n            // wrap sections\n      window.addEventListener('scroll', this._scrollEvent) // bing this, so that it refers to custom element instead of window\n    }\n\n    _scrollEvent (e) {\n      clearTimeout(this._scrollEvent.fn)\n      this._scrollEvent.fn = setTimeout(function () {\n        this.setActive()\n      }.bind(this), 10)\n    }\n        /**\n         * check if section wrapper is in viewport\n         */\n    get _inView () {\n      return this.getBoundingClientRect().bottom > 0\n    }\n        /**\n         * set _active property & add/remove active attr\n         */\n    _setActiveState (state) {\n            // set _active property\n      this._active = (state === true)\n            // add or remove active attribute\n      if (this._active) {\n        this.setAttribute('active', '')\n        return\n      } else {\n        this.removeAttribute('active')\n      }\n    }\n        // check if a child element is in view and set it to active\n    setActive () {\n      this._setActiveState(this._inView)\n            // if element is in view, active children\n      if (this._inView) {\n                // Get all child elements and activate visible ones\n                // stop once an inactive item follows an active item\n        var elements = this.querySelectorAll('page-section')\n        for (var i = 0; elements.length > i; ++i) {\n          elements[i].setActive()\n                    // abort if current element is NOT in view, but previous was in view\n          if (i > 0 && elements[i].active === false && elements[i - 1].active === true) {\n            return\n          }\n        }\n        return\n      }\n    }\n    }\n\n  const template = makeTemplate`<style>\n      :host{\n          display: flex;\n          flex-direction: column;\n          flex-wrap: nowrap;\n      }\n    </style>\n    <slot></slot>\n  `\n\n  ShadyCSS.prepareTemplate(template, 'page-sections') // eslint-disable-line no-undef\n  window.customElements.define('page-sections', PageSections)\n})()\n"]}