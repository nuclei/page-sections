{"version":3,"sources":["make-template.js","page-sections.js"],"names":["makeTemplate","strings","html","substs","i","length","template","document","createElement","innerHTML","PageSections","_active","shadowRoot","attachShadow","mode","ShadyCSS","applyStyle","appendChild","importNode","content","_scrollEvent","bind","window","addEventListener","e","clearTimeout","fn","setTimeout","setActive","state","setAttribute","removeAttribute","_setActiveState","_inView","elements","querySelectorAll","active","console","log","getBoundingClientRect","top","bottom","innerHeight","prepareTemplate","customElements","define"],"mappings":"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","file":"page-sections.js","sourcesContent":["const makeTemplate = function (strings, ...substs) {\n  var html = ''\n  for (let i = 0; i < substs.length; i++) {\n    html += strings[i]\n    html += substs[i]\n  }\n  html += strings[strings.length - 1]\n  var template = document.createElement('template')\n  template.innerHTML = html\n  return template\n}\n/**\n * export make template function\n */\nexport default makeTemplate\n","/* global HTMLElement */\nimport makeTemplate from './make-template';\n\n(function () {\n  class PageSections extends HTMLElement {\n\n    constructor () {\n            // needs to be called first\n      super()\n            // set sections initial active state to false\n      this._active = false\n            // create shadowRoot\n      const shadowRoot = this.attachShadow({mode: 'open'})\n            // add content to shadowRoot & apply css polyfill\n      ShadyCSS.applyStyle(this) // eslint-disable-line no-undef\n      shadowRoot.appendChild(document.importNode(template.content, true))\n    }\n        /**\n         * get active state of parent container\n         * @method active\n         * @return {Boolean}\n         */\n    get active () {\n      return this._active\n    }\n\n    connectedCallback () {\n      this._scrollEvent = this._scrollEvent.bind(this)\n            // wrap sections\n      window.addEventListener('scroll', this._scrollEvent) // bing this, so that it refers to custom element instead of window\n    }\n\n    _scrollEvent (e) {\n      clearTimeout(this._scrollEvent.fn)\n      this._scrollEvent.fn = setTimeout(function () {\n        this.setActive()\n      }.bind(this), 10)\n    }\n        /**\n         * check if section wrapper is in viewport\n         */\n    get _inView () {\n      console.log('Top: ' + this.getBoundingClientRect().top)\n      console.log('Bottom: ' + this.getBoundingClientRect().bottom + ', ' + window.innerHeight)\n      console.log('---------')\n      return this.getBoundingClientRect().bottom > 0\n    }\n        /**\n         * set _active property & add/remove active attr\n         */\n    _setActiveState (state) {\n            // set _active property\n      this._active = (state === true)\n            // add or remove active attribute\n      if (this._active) {\n        this.setAttribute('active', '')\n        return\n      } else {\n        this.removeAttribute('active')\n      }\n    }\n        // check if a child element is in view and set it to active\n    setActive () {\n      this._setActiveState(this._inView)\n            // if element is in view, active children\n      if (this._inView) {\n                // Get all child elements and activate visible ones\n                // stop once an inactive item follows an active item\n        var elements = this.querySelectorAll('page-section')\n        for (var i = 0; elements.length > i; ++i) {\n          elements[i].setActive()\n                    // abort if current element is NOT in view, but previous was in view\n          if (i > 0 && elements[i].active === false && elements[i - 1].active === true) {\n            return\n          }\n        }\n        return\n      }\n    }\n    }\n\n  const template = makeTemplate`<style>\n      :host{\n          display: flex;\n          flex-direction: column;\n          flex-wrap: nowrap;\n      }\n    </style>\n    <div class=\"o-page-sections\">\n        <slot></slot>\n    </div>`\n\n  ShadyCSS.prepareTemplate(template, 'page-sections') // eslint-disable-line no-undef\n  window.customElements.define('page-sections', PageSections)\n})()\n"]}