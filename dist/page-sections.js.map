{"version":3,"sources":["make-template.js","page-section.js","page-sections.js"],"names":["makeTemplate","strings","html","substs","i","length","template","document","createElement","innerHTML","ShadyCSS","prepareTemplate","PageSectionItem","isActive","shadowRoot","attachShadow","mode","applyStyle","appendChild","importNode","content","viewportHeight","window","innerHeight","box","getBoundingClientRect","top","bottom","activate","_isInView","setAttribute","dispatchEvent","Event","removeAttribute","PageSections","bind","_scrollEvent","addEventListener","e","clearTimeout","fn","setTimeout","elements","querySelectorAll","customElements","define","PageSection"],"mappings":"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","file":"page-sections.js","sourcesContent":["const makeTemplate = function (strings, ...substs) {\n    var html = '';\n    for (let i = 0; i < substs.length; i++) {\n        html += strings[i];\n        html += substs[i];\n    }\n    html += strings[strings.length - 1];\n    var template = document.createElement('template');\n    template.innerHTML = html;\n    return template;\n}\n/**\n * export make template function\n */\nexport default makeTemplate;\n","\nimport makeTemplate from './make-template';\n\nlet template = makeTemplate`<style>\n        :host{\n            display: inline-block;\n            flex: 0 1 auto;\n        }\n        :host(:not([flexible])){\n            box-sizing: border-box;\n            width: 100%;\n            min-height: 100vh;\n        }\n        :host([flexible]){\n            margin-left: 50%;\n            transform: translateX(-50%);\n        }\n    </style>`;\n\nShadyCSS.prepareTemplate(template, 'page-section');\n\nclass PageSectionItem extends HTMLElement {\n    constructor() {\n        // If you define a ctor, always call super() first!\n        // This is specific to CE and required by the spec.\n        super();\n        // by default isActive is false\n        this.isActive = false;\n        // Attach a shadow root to the element.\n        const shadowRoot = this.attachShadow({mode: 'open'});\n        ShadyCSS.applyStyle(this);\n        shadowRoot.appendChild(document.importNode(template.content, true));\n    }\n    /**\n     * check if element is in view\n     */\n    _isInView(viewportHeight){\n        viewportHeight = viewportHeight || window.innerHeight;\n        // get elements bounding box\n        var box = this.getBoundingClientRect();\n        // check if element is in view\n        if( (box.top >= 0 && (\n                box.top < viewportHeight *.5 ||\n                box.bottom <= viewportHeight )) ||\n            (box.top  < viewportHeight *.5 && box.bottom > viewportHeight*.5)\n        ){\n            return true;\n        }\n    }\n    /**\n     * When element is added to DOM\n     */\n    connectedCallback() {\n        // initialize activated state\n        this.activate();\n    }\n    /**\n     * set active if in viewport or unactive if not\n     */\n    activate() {\n        if(this._isInView()){\n            if(this.isActive === false){\n                // set attributes\n                this.setAttribute('active','');\n                this.isActive = true;\n                // Dispatch the event.\n                this.dispatchEvent(new Event('activated'));\n            }\n            // return true\n            return true;\n        }\n        // set element to unactive\n        if(this.isActive === true){\n            // set attributes\n            this.removeAttribute('active');\n            this.isActive = false;\n            // Dispatch the event.\n            this.dispatchEvent(new Event('deactivated'));\n        }\n    }\n}\n\nexport default PageSectionItem;\n","import makeTemplate from './make-template';\nimport PageSection from './page-section';\n\n(function() {\n\n    var template = makeTemplate`<style>\n      :host{\n          display: flex;\n          flex-direction: column;\n          flex-wrap: nowrap;\n      }\n    </style>\n    <div class=\"o-page-sections\">\n        <slot></slot>\n    </div>`;\n\n    ShadyCSS.prepareTemplate(template, 'page-sections');\n\n    class PageSections extends HTMLElement {\n\n        constructor() {\n            // If you define a ctor, always call super() first!\n            // This is specific to CE and required by the spec.\n            super();\n            // create shadowRoot\n            const shadowRoot = this.attachShadow({mode: 'open'});\n            ShadyCSS.applyStyle(this);\n            // shadowRoot.innerHTML = `\n            //     <style>\n            //       :host{\n            //           display: flex;\n            //           flex-direction: column;\n            //           flex-wrap: nowrap;\n            //       }\n            //     </style>\n            //     <div class=\"o-page-sections\">\n            //         <slot></slot>\n            //     </div>\n            // `;\n            // Attach a shadow root to the element.\n            // let shadowRoot = this.attachShadow({mode: 'open'});\n            // ShadyCSS.applyStyle(this);\n            shadowRoot.appendChild(document.importNode(template.content, true));\n        }\n\n        connectedCallback() {\n            this.activate = this.activate.bind(this);\n            this._scrollEvent = this._scrollEvent.bind(this);\n            // wrap sections\n            window.addEventListener('scroll', this._scrollEvent); // bing this, so that it refers to custom element instead of window\n        }\n\n        _scrollEvent(e) {\n            clearTimeout( this._scrollEvent.fn );\n            this._scrollEvent.fn = setTimeout( function(){\n                this.activate();\n            }.bind(this), 10);\n        }\n        // check if a child element is in view and set it to active\n        activate() {\n            if(this._isInView()){\n                // set section wrapper to active\n                this.isActive = true;\n                this.setAttribute('active','');\n                // get all child-sections\n                var elements = this.querySelectorAll('page-section');\n                // loop through all items\n                for(var i = 0; elements.length > i; ++i){\n                    // activate element\n                    elements[i].activate();\n                    // abort if current element is NOT in view, but previous was in view\n                    if(i > 0 && elements[i].isActive === false && elements[i-1].isActive === true){\n                        return;\n                    }\n                }\n                return;\n            }\n            // set section wrapper to active\n            this.isActive = false;\n            this.removeAttribute('active');\n        }\n        /**\n         * check if section wrapper is in viewport\n         */\n        _isInView(){\n            return this.getBoundingClientRect().bottom > 0;\n        }\n    }\n    window.customElements.define('page-sections', PageSections);\n    window.customElements.define('page-section', PageSection);\n})();\n"]}